<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('partials/head'); -%>
  <link rel="stylesheet" href="/javascripts/select2/css/select2.css">
</head>
<body class="hold-transition skin-green sidebar-mini">
  <div class="wrapper">
  <header class="main-header">
    <%- include('partials/header'); -%>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <%- include('partials/sidebar'); -%>
  </aside>
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        Inicio
      </h1>
      <ol class="breadcrumb">
        <li><i class="fa fa-dashboard"></i> Index</a></li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content container-fluid">

     <div class="box box-solid box-default">
        <div class="box-header with-border">
            <h3 class="box-title">Editar Servicio</h3>
            <div class="box-tools pull-right">
            </div>
        </div>
        <form action="javascript:;" method="post" id="createService" enctype="multipart/form-data">
        <div class="box-body">
                <div class="row">
                    <div class="col-md-5">
                        <div class="box box-solid box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">Información</h3>
                                <div class="box-tools pull-right">
                                </div>
                            </div>
                            <div class="box-body row">
                                <div class="form-group col-md-12 row">
                                    <div class="col-md-3">
                                      Nombre
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" class="form-control" id="Name_establecimiento" required="required" name="nombre" value="<%=servicio.nombre%>">
                                    </div>
                                </div>
                                <div class="form-group col-md-12 row">
                                    <div class="col-md-3">
                                      Categorias
                                    </div>
                                    <div class="col-md-9">
                                      <input type="hidden" id=" " value="<%= selectedCat %>">
                                        <select id="categoriesService" required="required" name="categories">
                                          <% categories.forEach(function(item) { %>
                                              <option value="<%=item.IdCategory%>" <%= caca %>><%=item.Name%></option>
                                          <% }); %>                                          
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group col-md-12 row">
                                    <div class="col-md-3">
                                      Precio
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" class="form-control" id="precio" required="required" name="precio" value="<%=servicio.precio %>">
                                        <input type="hidden" class="form-control" id="idEstablecimiento" required="required" name="idEstablishment" value="<%= idEstablecimiento %>">
                                    </div>
                                </div>
                                <div class="form-group col-md-12 row">
                                    <div class="col-md-3">
                                      Descripción
                                    </div>
                                    <div class="col-md-9">
                                        <textarea class="form-control" rows="5" id="Description" name="descripcion"><%=servicio.descripcion%></textarea>
                                        <input type="hidden" name='fotos' id="fotos_array" value="<%= servicio.fotos %>" />
                                        <input type="hidden" name='idService' id="idService" value="<%= servicio.idService %>" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="box box-solid box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">Paquete</h3>
                                <div class="box-tools pull-right">
                                </div>
                            </div>
                            <div class="box-body row">

                            <div class="form-group col-md-12 row">
                                    <div class="col-md-3">
                                      Servicios
                                    </div>
                                    <div class="col-md-10">
                                        <select id="servicePackage" name="servicePackage" class="js-example-basic-single">
                                          <% servicios.forEach(function(item) { %>
                                            <% if (findWithAttr(packageSer,"idService",item.idService) < 0 && item.idService != servicio.idService){ %>
                                                <option value="<%=item.idService  %>"><%=item.nombre%></option>
                                              <% } %>
                                          <% }); %>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                      <button type="button" onclick="addToPackage()" class="btn btn-success fa fa-plus"></button>
                                    </div>
                                </div>
                                <div class="col-md-12" id="content-package">
                                  <h4 class="box-title">Mis Servicios</h3>
                                  <!-- /.box-header -->
                                    <!-- See dist/js/pages/dashboard.js to activate the todoList plugin -->
                                    <ul class="todo-list">
                                      <% packageSer.forEach(function(item) { %>
                                      <li>
                                        <span class="text"><%= item.nombre %></span>
                                        <input type="hidden" id="option_<%= item.idService %>" value="<%= item.idService %>" name="packageServices" attr-name="<%= item.nombre %>" />
                                        <div class="tools"><i onclick="removePackage(this, <%= item.idService %>)" class="fa fa-trash-o"></i></div>
                                      </li>
                                      <% }); %>
                                    </ul>
                                  </div>
                                  <!-- /.box-body -->
                              </div>
                            </div>

                      </div>



                    <div class="col-md-7">
                        <div class="box box-solid box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">Fotos</h3>
                                <div class="box-tools pull-right" id="filecontainer">
                                    <input type="file" name='fotos_new' id="uploadFiles" accept=".jpg,.jpeg,.png" multiple/>
                                </div>
                            </div>
                            <div class="row timeline-body" id="contentImages">
                              <% servicio.fotos.forEach(function(foto)  {%>
                                <div class='col-md-4' style='overflow: hidden; height: 250px;margin-bottom:10px;' >
                                        <a class='fa fa-remove btn btn-danger' style='float:right;position: absolute;' OnClick="deleteLoadedImage(this, '<%=foto%>')" ></a>
                                        <img class='img-responsive img-rounded' src="http://localhost:51336/api/Show/Image/<%= foto%>/<%= servicio.idService%>" />
                                  </div>
                              <% });%>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-footer">
                    <a class="btn btn-default" href="/myStore/<%= idEstablecimiento %>/services">Volver</a>
                    <button type="submit" value="Submit" class="btn btn-info pull-right">Guardar</button>
                </div>
        </div>
    </div>
</form>
      
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

 <!-- Main Footer -->
  <footer class="main-footer">
    <%- include('partials/footer'); -%>
  </footer>
</div>
 <%
     function findWithAttr(array, attr, value) {
        for(var i = 0; i < array.length; i += 1) {
            if(array[i][attr] === value) {
                return i;
            }
        }
        return -1;
    }
     %>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="javascripts/jquery-1.11.0.min.js"><\/script>')
    </script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- AdminLTE App -->
    <script src="/AdminLTE/js/adminlte.min.js"></script>
    <script src="/AdminLTE/js/edit-service.js"></script>
    <script src="/AdminLTE/js/jquery.geocomplete.js"></script>
    <script src="/AdminLTE/js/jquery.geocomplete.min.js"></script>
    <script src="/javascripts/select2/js/select2.min.js"></script>
    <script src="https://maps.google.com/maps/api/js?libraries=places&key=AIzaSyACKCmiFSETqUlePLoEjdiDAv3huM58KJU"></script>

</body>
</html>